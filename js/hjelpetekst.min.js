!function(e){"use strict";return e.hjelpetekst={version:"0.3",isInitialized:!1,init:function(t,i,n){if(!e.hjelpetekst.isInitialized){e.hjelpetekst.isInitialized=!0;var s=(new Date).getTime(),l=0;if(t="undefined"!=typeof t?t:e("#pFlowId").val()||"",-1!=e.inArray(t,["200","230"])){i="undefined"!=typeof i?i:e("#pFlowStepId").val()||"",n="undefined"!=typeof n?n:"www.kursadmin.org"===location.hostname?"https://storage.googleapis.com/hjelpetekst.appspot.com/h1":"https://hjelpetekst.appspot.com/json-dev",e("#tabs").first().append('<li style="float:right;"><a class="tab_link" href="#" id="hjelpetekst_size_tool" style="background:yellow;border:1px solid #ABABAB;height:38px;"><small>A</small><big>A<big>A</big></big><span class="box"><span class="text">For å endre tekststørrelsen, hold Ctrl-tasten nede og trykk på + for å forstørre eller - for å forminske.</span></span></a></li>'),e("#hjelpetekst_size_tool").on("focusin mouseenter",function(){e(this).find("span.box").show()}).on("focusout mouseleave",function(){e(this).find("span.box").hide()}).on("click",function(e){e.preventDefault()}).find("span.box").hide();var o=function(t,i,n){i.length||(i=e('<div id="ht_p1000_cont" class="ui-tabs-panel ui-widget-content ui-corner-all" style="margin: 0 3px 10px; max-width: 605px; font-size: 125%; line-height: 1.4"><div style="margin: 2ex"></div></div>'),t.prepend(i)),n.length||(n=e('<div id="ht_p1000_tabs" class="sHTabs" style="margin: 0 3px;"><div class="sHTabsInner"><ul></ul></div></div>'),t.prepend(n))},a=function(t,i,n){i.on("click",function(){var i=this.parentNode;e("#ht_p1000_cont").find(":first-child").html(t.tekst),e("#ht_p1000_tabs").find("li").removeClass().addClass(function(){return(e(this).is(":first-child")?"first-":e(this).is(":last-child")?"last-":"")+(i===this?"":"non-")+"current"})}),n.append(i);for(var s=5;s>0;s--)t.selector==="$$__T"+s+"__$$"&&(i.attr("href","#t"+s).attr("id","ht_p1000_cont_t"+s).append(e("<span/>").text(t.tittel)),e("#ht_p1000_tabs").find("ul").append(n))},d=function(t,i,n){t.attr("title",i.tittel+" (Klikk for hjelp)"),t.on("click",function(){e.hjelpetekst.show(i.tittel,i.tekst,encodeURI(i.video),encodeURI(i.link))}),t.insertAfter(n)};e.getJSON(n+"/"+t+"-"+i+".json",function(t){if(function(t,i){e("head").append(t),i.on("click",function(t){e(t.target).is(".hjelpetekst-dialog-outer")&&e.hjelpetekst.hide()}),e("body").append(i),i.hide()}(e('<link rel="stylesheet" type="text/css" href="https://hjelpetekst.appspot.com/css/hjelpetekst.min.css" />'),e('<div id="hjelpetekst_dialog"></div>')),"hjelp"in t){for(var n=0;n<t.hjelp.length;n++){var r=t.hjelp[n];if("1000"==i&&/^\$\$__(.+)__\$\$$/.test(r.selector))o(e("#body"),e("#ht_p1000_cont"),e("#ht_p1000_tabs")),a(r,e("<a />"),e('<li class="non-current" />')),l++;else{r.selector=/^([^#\. ]*)$/.test(r.selector)?"#"+r.selector:r.selector;var p=e(r.selector);p.length?(l++,"Veiledning:"===r.tittel.substr(0,11)?d(e('<a class="hjelpetekst hjelpetekst-veiledning" href="javascript:void(0)">? <span>Veiledning</span></a>'),r,p):d(e('<a class="hjelpetekst" href="javascript:void(0)">?</a>'),r,p)):console.log("Elementet '"+r.selector+"' finnes ikke i denne visningen, og bør fjernes fra dokumentet.")}}"1000"==i&&e("#ht_p1000_tabs").find("li").filter(":last-child").removeClass().addClass("last-non-current").end().filter(":first-child").removeClass().addClass("first-non-current").end().find(e("#ht_p1000_cont_"+location.hash.substr(1)).length?"#ht_p1000_cont_"+location.hash.substr(1):":first-child").first().trigger("click"),console.log("Hjelpetekst.js har lagt inn "+l+" hjelpetekster i denne visningen. Prosessen tok "+((new Date).getTime()-s)+" ms.")}}),e(document).on("keydown.hjelpetekst",function(t){27==t.keyCode&&e.hjelpetekst.hide()})}}},hide:function(){e("#hjelpetekst_dialog").empty().hide()},show:function(t,i,n,s){var l=e('<div class="hjelpetekst-dialog-outer"><div class="hjelpetekst-dialog-content"><h3></h3><p></p></div></div>'),o=e('<button title="Lukk">&times;</button>');o.on("click",function(){e.hjelpetekst.hide()}),l.find("h3").text(t).prepend(o),l.find("p").text(i),n&&!function(t){t.attr("href",n),t.on("click",function(t){t.preventDefault(),e.hjelpetekst.video(this.href)}),e(".hjelpetekst-dialog-content",l).append(t)}(e('<a style="width:110px;">Video</a>')),s&&!function(t){t.attr("href",s),t.on("click",function(){e.hjelpetekst.hide()}),e(".hjelpetekst-dialog-content",l).append(t)}(e('<a style="width:110px; float:right;" target="_blank">Les mer</a>')),e(".hjelpetekst-dialog-content",l).append(e('<div style="clear:both;"></div>')),e("#hjelpetekst_dialog").show().css("display","table").empty().append(l)},video:function(t){var i=e("#hjelpetekst_dialog").find("p"),n=e("#hjelpetekst_dialog").find("iframe");n.length?(n.remove(),i.show()):(i.hide(),n=e('<iframe height="210" width="280" frameborder="0" allowfullscreen />'),n.attr("src",t+"?rel=0&autoplay=1"),n.insertBefore(i))}},e(function(){e.hjelpetekst.init(window.hjelpetekstStf,window.hjelpetekstVis,window.hjelpetekstUrl)})}(window.jQuery);